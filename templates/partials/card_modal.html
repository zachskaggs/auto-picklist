<div class="modal" onclick="closeCardModal()">
  <div class="modal-card" onclick="event.stopPropagation()">
    <h2>{{ item.card_name }}{% if item.collector_number %} ({{ item.collector_number }}){% endif %}</h2>
    {% if card %}
      <p class="badge">Matched via {{ strategy }}</p>
      {% if image_path %}
        <img id="card-img" class="card-image" data-base="/card/image/{{ card.id }}" data-size="normal" src="/card/image/{{ card.id }}?size=normal" onclick="this.classList.toggle('zoom')" />
      {% else %}
        <p>Image unavailable (offline or not cached).</p>
      {% endif %}
    {% else %}
      <p>Card not found on Scryfall.</p>
    {% endif %}
    <div style="margin-top: 12px; display:flex; gap:8px; flex-wrap:wrap;">
      <button class="btn secondary" onclick="closeCardModal()">Close</button>
      {% if card %}<button class="btn secondary" onclick="toggleImageSize('card-img')">Toggle size</button>{% endif %}
      <button class="btn" onclick="htmx.ajax('GET', '/cards/search?name={{ item.card_name }}&item_id={{ item.id }}', {target:'#card-modal', swap:'innerHTML'})">Search alternatives</button>
    </div>
  </div>
</div>
