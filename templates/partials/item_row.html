<div id="item-{{ item.id }}" class="item-row picklist-row {% if qty_remaining == 0 %}picked{% endif %} {% if item.purchase_price is not none and item.purchase_price > 5 %}high-value-card{% endif %}" data-item-id="{{ item.id }}" data-set-code="{{ item.set_code }}">
  <div class="item-main" onclick="openCard({{ item.id }})">
    <div class="item-title">
      <span class="item-name {% if item.printing and item.printing|lower == 'foil' %}foil-name{% endif %}">{{ item.card_name }}{% if item.collector_number %} ({{ item.collector_number }}){% endif %}</span>
      <span class="item-tags">
        {% if item.condition %}
          <span class="badge condition-{{ item.condition|lower }}">{{ item.condition }}</span>
        {% endif %}
        {% if item.language %}<span class="badge badge-lang">{{ item.language }}</span>{% endif %}
        {% if item.printing %}
          <span class="badge {% if item.printing|lower == 'foil' %}badge-foil{% else %}badge-printing{% endif %}">{{ item.printing }}</span>
        {% endif %}
        {% if item.purchase_price is not none %}
          <span class="badge badge-price">${{ '%.2f'|format(item.purchase_price) }}</span>
        {% endif %}
        {% if item.is_missing %}<span class="badge badge-missing">MISSING</span>{% endif %}
      </span>
    </div>
    {% if show_missing and item.order_refs %}
      <div class="missing-order">{{ item.order_refs }}</div>
    {% endif %}
    {% if show_missing and item.missing_note %}
      <div class="missing-order">{{ item.missing_note }}</div>
    {% endif %}
    
  </div>

  <div class="qty-col">{{ qty_remaining }} of {{ item.qty_required }}</div>
  <div>
    {% if show_picked and qty_remaining == 0 %}
      <button class="action-btn undo" hx-post="/items/{{ item.id }}/undo" hx-target="this" hx-swap="none" hx-include="#filters" hx-on::after-request="refreshItem({{ item.id }})">Unpick</button>
    {% else %}
      <button class="action-btn pick" hx-post="/items/{{ item.id }}/pick" hx-target="this" hx-swap="none" hx-include="#filters" hx-on::after-request="refreshItem({{ item.id }})" onclick="showToast('Picked {{ item.card_name }}', '/items/{{ item.id }}/undo', {{ item.id }})">Picked</button>
    {% endif %}
  </div>
  <div>
    {% if item.is_missing %}
      <button class="action-btn" hx-post="/items/{{ item.id }}/unmissing" hx-target="this" hx-swap="none" hx-include="#filters" hx-on::after-request="refreshItem({{ item.id }})">Unmissing</button>
    {% else %}
      <button class="action-btn missing" onclick="markMissing({{ item.id }})">Missing</button>
    {% endif %}
  </div>
</div>





